<mvc:View controllerName="project1.controller.MainView"
    xmlns:mvc="sap.ui.core.mvc" displayBlock="true"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:l="sap.ui.layout"
    xmlns:f="sap.f"
    xmlns:card="sap.f.cards">

    <Page id="compliancePage" title="HR Compliance &amp; Reporting Hub" titleAlignment="Center">
        
        <headerContent>
            <Button id="btnAlerts" icon="sap-icon://bell" type="Transparent" text="{= ${/dashboard/kpi/activeViolations} + ' Alerts' }" press=".onPressAlerts"/>
            <Avatar id="userAvatar" displaySize="XS" />
        </headerContent>

        <content>
            <IconTabBar id="idIconTabBar" expanded="true" class="sapUiResponsiveContentPadding">
                <items>
                    <!-- TAB 1: EXECUTIVE DASHBOARD -->
                    <IconTabFilter id="tabDashboard" icon="sap-icon://bbyd-dashboard" text="Dashboard" key="dashboard">
                        <VBox id="dashboardLayout" class="sapUiSmallMargin">
                            
                            <!-- KPI Tiles -->
                            <Title id="titleOverview" text="Executive Overview" titleStyle="H2" class="sapUiSmallMarginBottom"/>
                            <HBox id="tileLayout" wrap="Wrap" justifyContent="SpaceBetween">
                                <GenericTile id="tileScore" class="sapUiTinyMarginBegin sapUiTinyMarginTop" header="Compliance Score" subheader="Monthly Trend" press=".onPressTile">
                                    <TileContent id="contentScore" footer="Current">
                                        <NumericContent id="numScore" value="{/dashboard/kpi/complianceScore}" icon="sap-icon://line-chart" valueColor="Good" indicator="Up" />
                                    </TileContent>
                                </GenericTile>

                                <GenericTile id="tileViolations" class="sapUiTinyMarginBegin sapUiTinyMarginTop" header="Active Violations" subheader="Action Required" press=".onPressTile" frameType="OneByOne">
                                    <TileContent id="contentViolations" footer="Critical">
                                        <NumericContent id="numViolations" value="{/dashboard/kpi/activeViolations}" icon="sap-icon://alert" valueColor="Error" />
                                    </TileContent>
                                </GenericTile>

                                <GenericTile id="tileReports" class="sapUiTinyMarginBegin sapUiTinyMarginTop" header="Reports Generated" subheader="Govt Submission" press=".onPressTile">
                                    <TileContent id="contentReports" footer="This Month">
                                        <NumericContent id="numReports" value="{/dashboard/kpi/reportsGenerated}" icon="sap-icon://pdf-attachment" valueColor="Neutral"/>
                                    </TileContent>
                                </GenericTile>

                                <GenericTile id="tileAudits" class="sapUiTinyMarginBegin sapUiTinyMarginTop" header="Pending Audits" subheader="Review Needed" press=".onPressTile">
                                    <TileContent id="contentAudits" footer="To Do">
                                        <NumericContent id="numAudits" value="{/dashboard/kpi/pendingAudits}" icon="sap-icon://clipboard" valueColor="Critical"/>
                                    </TileContent>
                                </GenericTile>
                            </HBox>

                            <!-- Monthly Trend (Simulated Chart) -->
                            <Title id="titleTrend" text="Monthly Compliance Trend (2025)" titleStyle="H3" class="sapUiMediumMarginTop"/>
                            <List id="trendList" items="{/dashboard/trend}" noDataText="No trend data">
                                <CustomListItem id="trendItemTemplate">
                                    <HBox id="trendHBox" justifyContent="SpaceBetween" alignItems="Center" class="sapUiSmallMargin">
                                        <Label id="trendMonthLabel" text="{month}" width="50px" design="Bold"/>
                                        <ProgressIndicator id="trendScoreProgress" percentValue="{score}" displayValue="{score}%" showValue="true" state="Success" width="100%"/>
                                    </HBox>
                                </CustomListItem>
                            </List>

                            <!-- Critical Alerts -->
                            <Title id="titleAlerts" text="Critical Alerts" titleStyle="H3" class="sapUiMediumMarginTop"/>
                            <List id="alertsList" items="{/dashboard/alerts}" noDataText="No active alerts">
                                <StandardListItem id="alertItemTemplate" title="{message}" description="{date}" icon="sap-icon://alert" info="{type}" infoState="{= ${type} === 'Critical' ? 'Error' : 'Warning' }" />
                            </List>

                            <Button id="btnScan" text="Run Compliance Scan" type="Emphasized" icon="sap-icon://search" press=".onRunScan" class="sapUiMediumMarginTop"/>

                        </VBox>
                    </IconTabFilter>

                    <!-- TAB 2: STATUTORY REPORTING -->
                    <IconTabFilter id="tabReporting" icon="sap-icon://official-service" text="Reporting" key="reporting">
                        <VBox id="reportingLayout" class="sapUiSmallMargin">
                            <Title id="titleReporting" text="Statutory Reporting" titleStyle="H2" class="sapUiSmallMarginBottom"/>
                            
                            <Panel id="panelReport" headerText="Generate New Report" expandable="true" expanded="true" width="auto" class="sapUiResponsiveMargin">
                                <content>
                                    <VBox id="formLayout">
                                        <Label id="lblType" text="Select Form Type:" />
                                        <Select id="reportTypeSelect" width="100%" items="{/reporting/types}">
                                            <core:Item key="{key}" text="{text}" />
                                        </Select>

                                        <Label id="lblDate" text="Select Month:" class="sapUiSmallMarginTop"/>
                                        <DatePicker id="reportDate" displayFormat="MMM yyyy" valueFormat="MMM yyyy" width="100%"/>

                                        <Button id="btnGenerate" text="Generate Report" type="Emphasized" press=".onGenerateReport" class="sapUiSmallMarginTop"/>
                                    </VBox>
                                </content>
                            </Panel>

                            <Table id="historyTable" items="{/reporting/history}" width="auto" class="sapUiResponsiveMargin">
                                <headerToolbar>
                                    <Toolbar id="historyToolbar">
                                        <Title id="historyTitle" text="Generation History" level="H2"/>
                                    </Toolbar>
                                </headerToolbar>
                                <columns>
                                    <Column id="colHistoryType"><Text id="txtHistoryType" text="Report Name" /></Column>
                                    <Column id="colHistoryPeriod"><Text id="txtHistoryPeriod" text="Period" /></Column>
                                    <Column id="colHistoryStatus"><Text id="txtHistoryStatus" text="Status" /></Column>
                                    <Column id="colHistoryAction"><Text id="txtHistoryAction" text="Action" /></Column>
                                </columns>
                                <items>
                                    <ColumnListItem id="historyItemTemplate">
                                        <cells>
                                            <Text id="cellHistoryType" text="{type}" />
                                            <Text id="cellHistoryPeriod" text="{period}" />
                                            <ObjectStatus id="cellHistoryStatus" text="{status}" state="{state}" />
                                            <Button id="btnHistoryDownload" icon="sap-icon://download" type="Transparent" />
                                        </cells>
                                    </ColumnListItem>
                                </items>
                            </Table>
                        </VBox>
                    </IconTabFilter>

                    <!-- TAB 3: COMPLIANCE RULES -->
                    <IconTabFilter id="tabRules" icon="sap-icon://action-settings" text="Rules Config" key="rules">
                        <VBox id="rulesLayout" class="sapUiSmallMargin">
                            <Title id="titleRules" text="Compliance Rules Configuration" titleStyle="H2" class="sapUiSmallMarginBottom"/>
                            
                            <Table id="rulesTable" items="{/rules}">
                                <columns>
                                    <Column id="colRulesParameter"><Text id="txtRulesParameter" text="Parameter" /></Column>
                                    <Column id="colRulesValue"><Text id="txtRulesValue" text="Value" /></Column>
                                    <Column id="colRulesUnit"><Text id="txtRulesUnit" text="Unit" /></Column>
                                    <Column id="colRulesAction"><Text id="txtRulesAction" text="Action" /></Column>
                                </columns>
                                <items>
                                    <ColumnListItem id="rulesItemTemplate">
                                        <cells>
                                            <Text id="cellRuleParameter" text="{parameter}" />
                                            <Text id="cellRuleValue" text="{value}" />
                                            <Text id="cellRuleUnit" text="{unit}" />
                                            <Button id="btnEditRule" icon="sap-icon://edit" press=".onEditRule" />
                                        </cells>
                                    </ColumnListItem>
                                </items>
                            </Table>
                        </VBox>
                    </IconTabFilter>

                    <!-- TAB 4: AUDIT LOGS -->
                    <IconTabFilter id="tabAudit" icon="sap-icon://history" text="Audit Logs" key="audit">
                        <VBox id="auditLayout" class="sapUiSmallMargin">
                            <Title id="titleAudit" text="System Audit Logs" titleStyle="H2" class="sapUiSmallMarginBottom"/>
                            
                            <Table id="auditTable" items="{/auditLogs}">
                                <headerToolbar>
                                    <Toolbar id="auditToolbar">
                                        <SearchField id="auditSearch" placeholder="Filter by User ID..." search=".onFilterLogs" width="50%"/>
                                    </Toolbar>
                                </headerToolbar>
                                <columns>
                                    <Column id="colAuditDate"><Text id="txtAuditDate" text="Date &amp; Time" /></Column>
                                    <Column id="colAuditUser"><Text id="txtAuditUser" text="User" /></Column>
                                    <Column id="colAuditAction"><Text id="txtAuditAction" text="Action" /></Column>
                                </columns>
                                <items>
                                    <ColumnListItem id="auditItemTemplate">
                                        <cells>
                                            <Text id="cellAuditDate" text="{date}" />
                                            <Text id="cellAuditUser" text="{user}" />
                                            <Text id="cellAuditAction" text="{action}" />
                                        </cells>
                                    </ColumnListItem>
                                </items>
                            </Table>
                        </VBox>
                    </IconTabFilter>

                </items>
            </IconTabBar>
        </content>
    </Page>
</mvc:View>